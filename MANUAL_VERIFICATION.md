# 📋 手动验证指南

由于自动化测试有限制，请按照以下步骤手动验证系统功能：

## 🚀 步骤1: 启动服务

### 终端1 - 启动后端

```bash
cd /workspace/backend
python3 main.py
```

你应该看到类似输出：
```
INFO:     Started server process [xxxxx]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000
```

### 终端2 - 启动前端

```bash
cd /workspace/frontend
npm install
npm run dev
```

你应该看到类似输出：
```
  VITE v5.x.x  ready in xxx ms

  ➜  Local:   http://localhost:5173/
  ➜  Network: use --host to expose
```

## 🧪 步骤2: 验证后端API

在浏览器访问或使用curl测试：

### 2.1 测试根路径
```bash
curl http://localhost:8000/
```
应返回: `{"message":"API编排引擎运行中"}`

### 2.2 测试API文档
浏览器访问: `http://localhost:8000/docs`
应该看到Swagger UI界面

### 2.3 测试工具API
```bash
curl http://localhost:8000/api/tools/
```
应返回: `[]` (空数组，因为还没有工具)

## 🎨 步骤3: 验证前端界面

### 3.1 访问首页
浏览器访问: `http://localhost:5173`

**验证点:**
- ✅ 看到标题 "🔧 API编排引擎"
- ✅ 看到 "工具管理" 和 "创建工作流" 按钮
- ✅ 看到工作流列表表格（可能为空）

### 3.2 创建示例工具
在终端3运行：
```bash
cd /workspace/backend
python3 example_tools.py
```

应该看到10个工具创建成功的消息。

### 3.3 验证工具管理
1. 点击右上角 "工具管理" 按钮
2. **验证点:**
   - ✅ 看到工具列表，包含10个示例工具
   - ✅ 工具包括: HTTP GET请求、HTTP POST请求、文本处理等
3. 点击 "创建工具" 按钮
4. **验证点:**
   - ✅ 弹出创建对话框
   - ✅ 可以填写工具名称、描述、分类等
   - ✅ 可以编写Python代码

## 🔧 步骤4: 创建和测试工作流

### 4.1 创建工作流
1. 返回首页，点击 "创建工作流"
2. **验证点:**
   - ✅ 进入工作流编辑器
   - ✅ 左侧显示节点面板
   - ✅ 中间是画布（有背景网格）
   - ✅ 右侧是属性面板
   - ✅ 画布上已有一个"开始"节点

### 4.2 拖拽节点
1. 从左侧拖拽 "HTTP GET请求" 工具到画布
2. 拖拽 "结束" 节点到画布
3. **验证点:**
   - ✅ 节点成功添加到画布
   - ✅ 节点显示正确的图标和标签
   - ✅ 节点有不同的颜色

### 4.3 连接节点
1. 从"开始"节点底部的连接点拖拽到"HTTP GET请求"节点顶部
2. 从"HTTP GET请求"节点底部拖拽到"结束"节点顶部
3. **验证点:**
   - ✅ 节点之间出现连接线
   - ✅ 连接线带有箭头

### 4.4 配置节点
1. 点击"HTTP GET请求"节点
2. **验证点:**
   - ✅ 右侧属性面板显示节点配置
   - ✅ 可以选择工具
   - ✅ 可以添加输入参数
3. 添加参数 `url`，值填写: `https://jsonplaceholder.typicode.com/posts/1`
4. 设置输出变量名: `api_result`

### 4.5 保存工作流
1. 修改工作流名称为 "测试API调用"
2. 点击 "保存" 按钮
3. **验证点:**
   - ✅ 提示 "创建成功"
   - ✅ URL变化为 `/workflow/{id}`

### 4.6 执行工作流
1. 点击 "执行" 按钮
2. 在输入框中填写: `{}`
3. 点击 "确定"
4. **验证点:**
   - ✅ 提示 "执行完成"
   - ✅ 可以查看执行日志
   - ✅ 显示API返回的数据

## 🧩 步骤5: 测试高级功能

### 5.1 测试条件分支
1. 创建新工作流
2. 添加节点: 开始 → 代码节点 → 条件分支 → (两个不同路径) → 结束
3. 代码节点设置: `result = 85` (存到变量score)
4. 条件节点设置: `{{score}} > 60`
5. 连接true分支到一个代码节点（输出"及格"）
6. 连接false分支到另一个代码节点（输出"不及格"）
7. 执行并验证走true分支

### 5.2 测试循环
1. 创建新工作流
2. 添加节点: 开始 → 代码节点 → 循环节点 → 工具节点 → 结束
3. 代码节点创建数组: `result = [1, 2, 3, 4, 5]` (存到items)
4. 循环节点配置:
   - 类型: for
   - 迭代变量: items
   - 循环变量: item
5. 执行并验证循环5次

### 5.3 测试自定义代码节点
1. 添加代码节点
2. 编写代码:
```python
# 访问上下文
value = context.get('api_result', {})
# 处理数据
result = {
    'processed': True,
    'data': value
}
```
3. 执行并验证输出

## ✅ 验证检查清单

### 后端功能
- [ ] 后端服务启动成功
- [ ] API文档可访问
- [ ] 工具CRUD操作正常
- [ ] 工作流CRUD操作正常
- [ ] 工作流执行功能正常

### 前端界面
- [ ] 首页正常显示
- [ ] 工作流列表正常
- [ ] 工具管理页面正常
- [ ] 工作流编辑器加载成功
- [ ] 节点拖拽功能正常
- [ ] 节点连接功能正常
- [ ] 节点属性配置正常
- [ ] 保存工作流功能正常
- [ ] 执行工作流功能正常

### 节点类型
- [ ] 开始节点正常
- [ ] 结束节点正常
- [ ] 工具节点正常
- [ ] 条件分支节点正常
- [ ] 循环节点正常
- [ ] 代码节点正常

### 执行引擎
- [ ] 简单流程执行正常
- [ ] 条件分支执行正常
- [ ] 循环执行正常
- [ ] 变量传递正常
- [ ] 错误处理正常
- [ ] 执行日志记录正常

## 🐛 常见问题

### 问题1: 后端启动失败
```
解决: 检查8000端口是否被占用
lsof -i :8000
kill -9 <PID>
```

### 问题2: 前端无法连接后端
```
解决: 检查vite.config.js中的代理配置
确保后端在8000端口运行
```

### 问题3: 工作流执行失败
```
解决: 
1. 检查节点配置是否完整
2. 查看执行日志中的错误信息
3. 确保工具代码语法正确
```

### 问题4: 节点拖拽不生效
```
解决:
1. 刷新页面
2. 检查浏览器控制台是否有错误
3. 确保Vue Flow库正确加载
```

## 📸 预期效果截图说明

### 首页
- 顶部: 黑色导航栏，标题和按钮
- 内容: 白色卡片，工作流表格

### 工作流编辑器
- 左侧: 白色面板，可折叠的节点列表
- 中间: 灰色画布，带网格背景
- 右侧: 白色面板，节点属性表单
- 底部: 缩放控制、小地图

### 节点样式
- 开始节点: 绿色边框，淡绿色渐变背景
- 结束节点: 红色边框，淡红色渐变背景
- 工具节点: 蓝色边框，淡蓝色渐变背景
- 条件节点: 橙色边框，淡橙色渐变背景
- 循环节点: 青色边框，淡青色渐变背景
- 代码节点: 紫色边框，淡紫色渐变背景

## 🎉 验证完成

如果以上所有检查点都通过，恭喜！系统运行完全正常！

现在你可以：
1. 创建更多自定义工具
2. 构建复杂的工作流
3. 集成到实际业务中
4. 根据需求扩展功能

---

**祝使用愉快! 🚀**
